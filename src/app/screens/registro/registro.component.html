<section class="auth auth-register">
	<div class="auth-container">
		<h1>Registro</h1>
		<p class="subtitle">Llene la información con cuidado</p>

		<form class="form" [formGroup]="form" (ngSubmit)="submit()">
			<h3 class="section-title">Información Personal</h3>
			<div class="grid-2">
				<label>
					Nombre (s) *
					<input type="text" formControlName="nombre" placeholder="Ingresa tu nombre">
					<div *ngIf="form.get('nombre')?.invalid && form.get('nombre')?.touched" class="err-field">
                        <small *ngIf="form.get('nombre')?.errors?.['required']">El nombre es requerido.</small>
                    </div>
				</label>
				<label>
					Apellido Paterno *
					<input type="text" formControlName="apellidoP" placeholder="Ingresa tu apellido paterno">
					<div *ngIf="form.get('apellidoP')?.invalid && form.get('apellidoP')?.touched" class="err-field">
                        <small>El apellido paterno es requerido.</small>
                    </div>
				</label>
				<label>
					Apellido  Materno
					<input type="text" formControlName="apellidoM" placeholder="Ingresa tu apellido materno">
				</label> 
				<label>
					Correo electrónico *
					<input type="email" formControlName="email" placeholder="Ingresa tu correo electrónico">
					<div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="err-field">
                        <small *ngIf="form.get('email')?.errors?.['required']">El correo es requerido.</small>
                        <small *ngIf="form.get('email')?.errors?.['email']">El formato del correo no es válido.</small>
                    </div>
				</label>
				<label>
					Teléfono *
					<input type="tel" formControlName="telefono" (input)="formatPhoneNumber($event)"  maxlength="12" placeholder="Ingresa tu número de teléfono">
					<div *ngIf="form.get('telefono')?.invalid && form.get('telefono')?.touched" class="err-field">
                        <small>El teléfono debe tener 10 dígitos.</small>
                    </div>
				</label>
				<label>
					Contraseña *
					<input type="password" formControlName="password" placeholder="Ingresa tu contraseña">
					<div *ngIf="form.get('password')?.invalid && form.get('password')?.touched" class="err-field">
                        <small>La contraseña debe tener al menos 6 caracteres.</small>
                    </div>
				</label>
				<label>
    				Confirma tu contraseña *
    				<input type="password" formControlName="confirmPassword" placeholder="Repite la contraseña">
					<div *ngIf="form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched" class="err-field">
                        <small>Debes confirmar la contraseña.</small>
                    </div>
				</label>
			</div>

			<p class="err" *ngIf="form.hasError('passwordsMismatch') && form.get('confirmPassword')?.touched">
                Las contraseñas no coinciden.
            </p>

			<h3 class="section-title">Información de tus hijos</h3>
            <div formArrayName="hijos" class="hijos">
                <div class="hijo" *ngFor="let hijoForm of hijos.controls; let i = index" [formGroupName]="i">
                    <div class="grid-2">
                        <label>
                            Nombre (s) *
                            <input type="text" formControlName="nombre" placeholder="Ingresa su nombre">
                            <div *ngIf="hijoForm.get('nombre')?.invalid && hijoForm.get('nombre')?.touched" class="err-field">
                                <small>El nombre del hijo es requerido.</small>
                            </div>
                        </label>
                        <label>
                            Apellido Paterno *
                            <input type="text" formControlName="apellidoPaterno" placeholder="Ingresa su apellido paterno">
                            <div *ngIf="hijoForm.get('apellidoPaterno')?.invalid && hijoForm.get('apellidoPaterno')?.touched" class="err-field">
                                <small>El apellido paterno es requerido.</small>
                            </div>
                        </label>
                        <label>
                            Apellido Materno 
                            <input type="text" formControlName="apellidoMaterno" placeholder="Ingresa su apellido materno">
                        </label>
                        <label>
                            Fecha de nacimiento *
                            <input type="date" formControlName="fechaNacimiento" placeholder="DD/MM/AAAA">
                            <div *ngIf="hijoForm.get('fechaNacimiento')?.invalid && hijoForm.get('fechaNacimiento')?.touched" class="err-field">
                                <small>La fecha de nacimiento es requerida.</small>
                            </div>
                        </label>
                        <label>
                            Sexo *
                            <select formControlName="sexo">
                                <option value="H">Hombre</option>
                                <option value="M">Mujer</option>
                            </select>
                            <div *ngIf="hijoForm.get('sexo')?.invalid && hijoForm.get('sexo')?.touched" class="err-field">
                                <small>El sexo es requerido.</small>
                            </div>
                        </label>
                        <label>
                            Alergias
                            <input type="text" formControlName="alergias" placeholder="Ingresa sus alergias">
                        </label>
                    </div>
                    <div class="hijo-actions" *ngIf="hijos.length > 1">
                        <button type="button" class="btn-secondary" (click)="eliminarHijo(i)">Eliminar hijo</button>
                    </div>
                </div>
            </div>

			<div class="actions">
				<button type="button" class="btn-link" (click)="agregarHijo()">+ Agregar hijo</button>
			</div>

			<p class="err" *ngIf="errorMsg">{{ errorMsg }}</p>

			<div class="actions">
				<button type="submit" class="btn-primary" [disabled]="loading">
                    {{ loading ? 'Registrando...' : 'Registrarse' }}
                </button>
			</div>
			
		</form>
	</div>
</section>
